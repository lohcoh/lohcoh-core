@namespace LowKode.Core.Components

@using LowKode.Core.Metadata
@using LowKode.Core.Context
@using Microsoft.AspNetCore.Components.Rendering

@inherits LowKode.Core.Components.SiteComponentBase

@componentFragment


@code {
    RenderFragment componentFragment;

    protected override void OnInitialized()
    {
        // this component's only job is to set the value of Context.ComponentSiteSpecification before passing the 
        // context to ComponentSiteFragment to finish the real work of rendering the component.
        //
        // by the time this code is executed a new context has been created for this component.
        // changing the componentSpecification.ComponentType property only alters the value of componentSpecification.ComponentType 
        // in this component's context.
        var componentSpecification = Context.ComponentSiteSpecification;
        componentSpecification.ComponentType = Metadata.DependencyTypes.Where(o => o.System.Type == typeof(DisplayName));
        componentFragment = new ComponentSiteFragment(Context);
    }
}

